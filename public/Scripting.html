<h1 id="scripting-strategy">Scripting Strategy</h1><h2 id="mindset">Mindset</h2><p>Scripting with a CMS like Webflow is tricky, and it&#39;s even trickier to add scripts without bloating the page weight.</p><p>At GV we needed a way to easily and quickly add additional functionality to our projects, without needing too much extra processing power.</p><p>We&#39;re basing our strategy on OG web performance optimizer Steve Souder&#39;s <a href="https://stevesouders.com/examples/rules.php">14 Rules for Faster-Loading Web Sites. </a>.</p><ul><li><em>Rule 6</em>: Put scripts at the bottom</li><li><em>Rule 8</em>: Make Javascript external</li><li><em>Rule 10</em>: Minify Javascript</li></ul><h2 id="script-strategy">Script strategy</h2><p>We&#39;ve created GitHub repositories for the scripts we commonly used, and created a pipeline to automatically add them to your site. To include one of these scripts, you only need to follow two steps:</p><ol><li>Add an HTML embed or inline element and give it a class like <code>.gv-[script-name]</code>.</li><li>Optionally, change data-attributes to change script options</li><li>Add a script tag to the document head with the following format <code>&lt;script src=&quot;./js/[script-name].min.js defer&quot;&gt;</code></li><li>Add the scripts you used in the project to the Pusherman options</li></ol><blockquote><p>If the script is only used on one page, only add the script tag to the custom code for that page. If it will be used globally, use the site-wide custom code.</p></blockquote><p>Read more about the <a href="Deployment.md">build process</a>.</p><h2 id="gv-scripts">GV Scripts</h2><p>#carbon</p><h4 id="carbon"><code>carbon</code></h4><p>This will display the CO2 per page view and the percentile rating. Forked directly from Wholegrain digital&#39;s <a href="gitlab.com/wholegrain/(https://gitlab.com/wholegrain/website-carbon-badges/">carbon badge</a></p><p><strong>Usage:</strong> Add a span, usually somewhere in the footer, and give it the <code>gv-carbon</code> classname.</p><p>#hide-email</p><h4 id="hide-email"><code>hide-email</code></h4><p>Obfuscate&#39;s the client&#39;s email to hide it from scrapers and bots.</p><p><strong>Usage:</strong> Add the clients email to an element&#39;s attributes. If the client&#39;s email is <a href="mailto:&#x69;&#x6e;&#x66;&#x6f;&#64;&#101;&#120;&#x61;&#109;&#112;&#108;&#x65;&#46;&#x63;&#111;&#109;">&#x69;&#x6e;&#x66;&#x6f;&#64;&#101;&#120;&#x61;&#109;&#112;&#108;&#x65;&#46;&#x63;&#111;&#109;</a>, then add <code>data-user = &quot;info&quot;</code>, <code>data-site = &quot;example.com&quot;</code>.</p><p>The script will store the first set of <code>user</code> and <code>site</code> values it finds in the document. It will use those for each new instance of <code>.gv-hide-email</code>, unless those values are overridden by a new set. This lets you use multiple emails on the same page.</p><blockquote><p>To have the final site display the text inside the span instead of the client&#39;s email, add the optional attribute to <code>data-keep-text</code></p></blockquote><p><strong>Options:</strong> | Attribute | Description | Required? | Example | | ---------------- | -------------------------------------------------------- | --------- | ----------------- | | data-site | The email domain | Yes | greenvision.media | data-user | The email username | Yes | hello | data-keep-text | Lets you keep whatever text is inside the link (Boolean) | Yes | N/A</p><p>#youtube</p><h4 id="youtube"><code>youtube</code></h4><p>Adds a high-performance youtube embed to your page. Forked directly from <a href="https://github.com/paulirish/lite-youtube-embed">this github project</a></p><p><strong>Usage:</strong> Add a div with the class <code>gv-youtube</code> , then add the video&#39;s ID to the attributes.</p><p><strong>Options:</strong> | Attribute | Description | Required? | Example | | ---------------- | -------------------------------------------------------- | --------- | ----------------- | | data-id | The youtube id (the code after watch?v= in the YT url) | Yes | y6120QOlsfU | data-thumbnail | Specify a path to the a thumbnail. Overrides YT&#39;s default | No | ./images/jfk | data-params | Specify youtube player parameters (see <a href="https://developers.google.com/youtube/player_parameters#Parameters">this</a> docs page) | No | controls=0&amp;start=10&amp;end=30</p><p>#basin</p><h4 id="basin"><code>basin</code></h4><p>Adds an ajax-enabled form to your site. Uses usebasin.com, read <a href="https://usebasin.com/docs/">their docs</a> for an in depth explanation.</p><p><strong>Usage:</strong> Paste your Basin form endpoint into the &quot;actions&quot; field in Webflow element settings, and give the form component the <code>gv-basin</code> class.</p><p>When submitted <em>successfully</em>, the form (that is, not the wrapper form component but the actual HTML form) will disappear. The div with the class <code>w-form-done</code> will appear. If the submit fails, the form will remain and the dib with the class <code>w-form-done</code> will appear.</p><blockquote><p>You don&#39;t need to add these classes in webflow; this works out of the box with webflow&#39;s failure and success divs.</p></blockquote><h2 id="script-writing-strategy">Script writing strategy</h2><h3 id="prettier">Prettier</h3><p>We use <a href="https://prettier.io/">Prettier</a> to keep our code formatting consistant, and to make sure we&#39;re faced with as few unimportant decisions as possible while coding. We know some people don&#39;t love opinionated code formatters, but we&#39;re very much of the mindset that there&#39;s no best way to format code, as long as everyone is doing it the same.</p><p>You&#39;ll need to install the prettier extension in VScode and make it your default formatter. There&#39;s a guide on this <a href="https://www.digitalocean.com/community/tutorials/how-to-format-code-with-prettier-in-visual-studio-code">here</a>.</p><h3 id="gulp">Gulp</h3><p>We use <a href="https://gulpjs.com/">Gulp</a> to automate build processes. Mostly, this is used to minify our code, but we also like the plugin <code>gulp-replace</code> for certain scripts, where it&#39;s necessary to inject CSS or HTML directly from the script.</p><h3 id="script-template">Script template</h3><p>We have created a <a href="github.com/greenvisionmedia/template">template</a> with a nice predefined directory structure. It has a <code>.gulpfile</code> that will work for most plugins, and a <code>prettierrc.yaml</code> that has our favorite Prettier options. You might need to run <code>&gt;npm install</code> to get gulp installed in the directory - then just run <code>&gt;gulp</code> to get site-ready files in the /public directory.</p>